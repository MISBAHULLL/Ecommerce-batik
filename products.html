<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produk - Batik Indonesia</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Navbar Container -->
    <div id="navbar-container"></div>

    <!-- Header Container -->
    <div id="header-container"></div>

    <main>
        <!-- Filter Section -->
        <section class="py-4 bg-white border-bottom">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <div class="d-flex align-items-center">
                            <label for="categoryFilter" class="form-label me-3 mb-0">Filter Kategori:</label>
                            <select id="categoryFilter" class="form-select" style="width: auto;">
                                <option value="">Semua Kategori</option>
                                <option value="Solo">Batik Solo</option>
                                <option value="Yogyakarta">Batik Yogyakarta</option>
                                <option value="Pekalongan">Batik Pekalongan</option>
                                <option value="Cirebon">Batik Cirebon</option>
                                <option value="Madura">Batik Madura</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-center justify-content-md-end">
                            <label for="sortBy" class="form-label me-3 mb-0">Urutkan:</label>
                            <select id="sortBy" class="form-select" style="width: auto;">
                                <option value="name">Nama A-Z</option>
                                <option value="price-low">Harga Terendah</option>
                                <option value="price-high">Harga Tertinggi</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Products Section -->
        <section class="py-5">
            <div class="container">
                <div class="row" id="productsContainer">
                    <!-- Produk akan dimuat dari JavaScript -->
                </div>
                
                <!-- Loading indicator -->
                <div id="loadingIndicator" class="text-center py-4" style="display: none;">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-2">Memuat produk...</p>
                </div>
                
                <!-- No products message -->
                <div id="noProductsMessage" class="text-center py-5" style="display: none;">
                    <i class="bi bi-search display-1 text-muted"></i>
                    <h3 class="mt-3">Tidak ada produk ditemukan</h3>
                    <p class="text-muted">Coba ubah filter atau kata kunci pencarian</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer Container -->
    <div id="footer-container"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/data.js"></script>
    <script src="js/cart-simple.js"></script>
    <script src="js/components.js"></script>
    <script>
        let currentProducts = [];
        
        // Load komponen halaman
        document.addEventListener('DOMContentLoaded', function() {
            // Load navbar, header, dan footer
            loadComponents('products', 'Koleksi Produk Batik', 'Temukan berbagai macam batik berkualitas dari seluruh Indonesia');
            
            // Load produk
            loadProducts();
            
            // Event listeners
            document.getElementById('categoryFilter').addEventListener('change', filterProducts);
            document.getElementById('sortBy').addEventListener('change', sortProducts);
        });
        
        // Load semua produk
        function loadProducts() {
            const container = document.getElementById('productsContainer');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const noProductsMessage = document.getElementById('noProductsMessage');
            
            loadingIndicator.style.display = 'block';
            container.innerHTML = '';
            noProductsMessage.style.display = 'none';
            
            setTimeout(() => {
                currentProducts = [...window.productsData];
                displayProducts(currentProducts);
                loadingIndicator.style.display = 'none';
            }, 500);
        }
        
        // Tampilkan produk
        function displayProducts(products) {
            const container = document.getElementById('productsContainer');
            const noProductsMessage = document.getElementById('noProductsMessage');
            
            if (products.length === 0) {
                container.innerHTML = '';
                noProductsMessage.style.display = 'block';
                return;
            }
            
            noProductsMessage.style.display = 'none';
            
            const productsHTML = products.map((product, index) => `
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card h-100 shadow-modern" style="animation-delay: ${index * 0.1}s">
                        <div class="position-relative overflow-hidden">
                            <img src="${product.image}" class="card-img-top" alt="${product.name}">
                            <div class="position-absolute top-0 start-0 m-3">
                                <span class="badge glass text-white">${product.category}</span>
                            </div>
                            <div class="position-absolute bottom-0 end-0 m-3">
                                <button class="btn btn-light btn-sm rounded-circle" onclick="toggleWishlist(${product.id})" title="Tambah ke Wishlist">
                                    <i class="bi bi-heart"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">${product.name}</h5>
                            <p class="card-text flex-grow-1">${product.description}</p>
                            <div class="mt-auto">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <span class="price-tag">${formatPrice(product.price)}</span>
                                    <div class="rating">
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                    </div>
                                </div>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="addToCart(${product.id})">
                                        <i class="bi bi-cart-plus me-2"></i>Tambah ke Keranjang
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = productsHTML;
        }
        
        // Filter produk
        function filterProducts() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            let filteredProducts = [...window.productsData];
            
            if (categoryFilter) {
                filteredProducts = filteredProducts.filter(product => 
                    product.category === categoryFilter
                );
            }
            
            currentProducts = filteredProducts;
            sortProducts();
        }
        
        // Urutkan produk
        function sortProducts() {
            const sortBy = document.getElementById('sortBy').value;
            
            switch (sortBy) {
                case 'name':
                    currentProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'price-low':
                    currentProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    currentProducts.sort((a, b) => b.price - a.price);
                    break;
            }
            
            displayProducts(currentProducts);
        }
        
        // Tambah ke keranjang
        function addToCart(productId) {
            window.cart.addToCart(productId, 1);
        }
        
        // Toggle wishlist (placeholder function)
        function toggleWishlist(productId) {
            const button = event.target.closest('button');
            const icon = button.querySelector('i');
            
            if (icon.classList.contains('bi-heart')) {
                icon.classList.remove('bi-heart');
                icon.classList.add('bi-heart-fill');
                button.classList.add('text-danger');
                // Simulasi notifikasi
                showNotification('Ditambahkan ke wishlist!');
            } else {
                icon.classList.remove('bi-heart-fill');
                icon.classList.add('bi-heart');
                button.classList.remove('text-danger');
                showNotification('Dihapus dari wishlist!');
            }
        }
        
        // Show notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'alert alert-success position-fixed';
            notification.style.cssText = 'top: 100px; right: 20px; z-index: 9999; min-width: 300px;';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 3000);
        }
    </script>
</body>
</html>